[
  {
    "path": "research_portfolio/2022-03-08-Mountain-Yellow-legged-frog-Analysis/",
    "title": "Mountain Yellow-legged frog Analysis",
    "description": "For this analysis, I will be looking at data provided by Knapp et al. (2020), which catalogues data between 1995-2002 on amphibian species counted in \"The Sierra Lakes Inventory Project\" (SLIP) to examine mountain yellow-legged frog (Rana muscosa) population numbers across life stages in the study region.",
    "author": [],
    "date": "2022-03-11",
    "categories": [],
    "contents": "\nMountain Yellow-legged frog Analysis\nFor this analysis, I will be looking at data provided by Knapp et al. (2020), which catalogues data between 1995-2002 on amphibian species counted in “The Sierra Lakes Inventory Project” (SLIP) to examine mountain yellow-legged frog (Rana muscosa) (RAMU in the data and plots) population numbers across life stages in the study region. Particularly, we are interested in identifying observations of Adults, SubAdults, and Tadpoles over the study period (1995-2002) as well as identifying the top 5 lakes with the greatest total observed counts of Adults and SubAdults.\n\n\nhide\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(lubridate)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(cowplot)\nlibrary(plotly)\nlibrary(patchwork)\nlibrary(readxl)\n\n\n\nMaking a graph of mountain yellow-legged frog (RAMU) count each year across all water bodies\nThis analysis removes unnecessary parameters from the data to look at counts of mountain yellow-legged frogs (RAMU) across three life stages of interest: Adults, SubAdults, and Tadpoles. We will then show counts by year (see Figure 1).\n\n\nhide\n\n# Making a graph of mountain yellow-legged frog count each year across all water bodies\nsierra_amphibians <- read_excel(\"data/sierra_amphibians.xlsx\") %>% \n  clean_names()\n\n\n\n\n\nhide\n\n# Cleaning data to look at parameters of interest\nsierra_amphibians_clean <- sierra_amphibians %>%\n  mutate(date_new = ymd(survey_date)) %>%\n  mutate(year = year(date_new)) %>%\n  filter(amphibian_species %in% c(\"RAMU\")) %>%\n  filter(amphibian_life_stage %in% c(\"Adult\", \"SubAdult\", \"Tadpole\"))\n\n\n\n\n\nhide\n\n# Grouping by year and amphibian life stage and then summing amphibian number\nsierra_amphibian_RAMUcount <- sierra_amphibians_clean %>%\n  group_by(year, amphibian_life_stage)\n\n\n\n\n\nhide\n\n# Plotting RAMU counts \nsierra_amphibian_RAMUcount %>% \n  ggplot(aes(x = as.factor(year), y = amphibian_number, fill = amphibian_life_stage)) +\n  geom_col() +\n  theme_cowplot(12) +\n  labs(x = \"Count by of RAMU by life stage across study period\", y = \"Number of RAMU counted\", title = \"Total RAMU numbers counted across lake sites\", subtitle = \"between 1995-2002\") +\n  facet_wrap(~amphibian_life_stage, scales = \"free\") +\n  theme(axis.text.x = element_text(angle = 45, hjust =1)) +\n  guides(fill=guide_legend(title=\"Amphibian Life Stage\"))\n\n\n\n\nFigure 1 Total counts of mountain yellow-legged frog (RAMU) counts by Adults, SubAdults and Tadpoles between 1995-2002 across all water bodies in the study region. Data: Knapp et al. 2020.\nAnalysis of the 5 lakes with the highest counts of Adult and SubAdult mountain yellow-legged frogs\nWe are interested in just identifying the 5 lakes with the highest counts of Adult and SubAdult mountain yellow frogs. For this we grouped the data by Lake ID and summarized data by ‘amphibian_number’ for the life stages of interest (see Figure 2).\n\n\nhide\n\n# adding \"Lake\" to lake_id and grouping by Lake\nsierra_amphibians_lake <- sierra_amphibian_RAMUcount %>%\n  mutate(lake_id = paste('Lake', lake_id)) %>% \n  filter(amphibian_life_stage %in% c(\"Adult\", \"SubAdult\")) %>% \n  group_by(lake_id) %>%\n  summarize(amphibian_number = sum(amphibian_number))\n\n\n\n\n\nhide\n\n# creating new table with 5 lakes with the highest Adult and SubAdult counts\ntop_5_lakes <- sierra_amphibians_lake %>% \n  slice_max(order_by = amphibian_number, n = 5)\n\n\n\n\n\nhide\n\n# Plotting top 5 lakes\ntop_5_lakes %>% \n  ggplot(aes(fct_rev(fct_reorder(lake_id, amphibian_number)), amphibian_number))+\n  geom_col() +\n  geom_col(stat = \"identity\", fill = \"dark cyan\", color = \"black\") +\n  labs(x = \"Lake (by ID) with highest RAMU counts over study period\", y = \"Number of RAMU counted\", title = \"5 Lakes with highest Adult/SubAdult RAMU numbers\", subtitle = \"between 1995-2002\") +\n  theme_cowplot()\n\n\n\n\nFigure 2 Depicts the top 5 lakes in the study region counting all the Adult and SubAdults counts observed over the study period (1995-2002). Data: Knapp et al. 2020).\nCombined Figure for Analysis\nWe combine Figure 1 and Figure 2 to aid in visual analysis of the mountain-yellow legged frog population over the study period and study region (see Figure 3).\n\n\nhide\n\nRAMU_plot <- sierra_amphibian_RAMUcount %>% \n  ggplot(aes(x = as.factor(year), y = amphibian_number, fill = amphibian_life_stage)) +\n  geom_col() +\n  theme_cowplot(font_size = 10) +\n  labs(x = \"Count of RAMU by life stage\", y = \"RAMU count\", title = \"Total mountain yellow-legged frogs (RAMU) counted at all lake sites\") +\n  facet_wrap(~amphibian_life_stage, scales = \"free\") +\n  theme(axis.text.x = element_text(angle = 45, hjust =1)) +\n  guides(fill=guide_legend(title=\"Amphibian Life Stage\"))\n\ntop5_plot <- top_5_lakes %>% \n  ggplot(aes(fct_rev(fct_reorder(lake_id, amphibian_number)), amphibian_number)) +\n  geom_col() +\n  geom_col(stat = \"identity\", fill = \"dark cyan\", color = \"black\") +\n  labs(x = \"Lakes with highest total Adult & SubAdult counts\", y = \"RAMU count\", title = \"5 Lakes with highest RAMU counts\", subtitle = \"over entire study period 1995-2002\") +\n  theme_cowplot(font_size = 10)\n\nRAMU_plot / top5_plot\n\n\n\n\nFigure 3 This figure combines Figure 1 and Figure2 to aid in the analysis of the data. Data: Knapp et al. 2020.\nCitation\nData citation: Knapp, R.A., C. Pavelka, E.E. Hegeman, and T.C. Smith. 2020. The Sierra Lakes Inventory Project: Non-Native fish and community composition of lakes and ponds in the Sierra Nevada, California ver 2. Environmental Data Initiative. https://doi.org/10.6073/pasta/d835832d7fd00d9e4466e44eea87fab3\n\n\n\n",
    "preview": "research_portfolio/2022-03-08-Mountain-Yellow-legged-frog-Analysis/Mountain-Yellow-legged-frog-analysis_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2022-03-11T11:41:18-08:00",
    "input_file": "Mountain-Yellow-legged-frog-analysis.knit.md"
  },
  {
    "path": "research_portfolio/2022-03-08-Mono-Lake/",
    "title": "History of Mono Lake Level (1850 - 2017)",
    "description": "In this analysis, I wanted to plot Mono Lake water levels with important ecological indicators and major legal milestones to see how water levels changed from specific events.",
    "author": [
      {
        "name": "Brendan McGovern",
        "url": {}
      }
    ],
    "date": "2022-03-08",
    "categories": [],
    "contents": "\nHistory of Mono Lake levels (1850 - 2017) with important ecological indicators and major legal milestones\n\n\nhide\n\nmono_lake <- read_csv((file = 'data/mono_lake_annual_levels.csv'), skip = 5)\n\n\n\n\n\nhide\n\nmono_lake_clean <- mono_lake %>% \n  clean_names() \n\n\n\n\n\nhide\n\nmono_lake_clean %>% \n  ggplot(aes(x = year, y = lake_level_feet_above_sea_level)) +\n  geom_line(size = 1.25, color = \"cyan4\", alpha = 1) +\n  geom_ribbon(aes(ymin = -Inf, ymax = lake_level_feet_above_sea_level), fill = \"darkcyan\", alpha = 0.2) +\n  scale_x_continuous(limits = c(1850, 2019), breaks = c(1850, 1875, 1900, 1925, 1950, 1975, 2000, 2017), expand = c(0,0)) +\n  geom_hline(yintercept = 6377, color = \"goldenrod2\", size = 1) +\n  geom_hline(yintercept = 6360, color = \"firebrick\", size = 1) + \n  geom_hline(yintercept = 6350, color = \"black\", size = 1) +\n  geom_point(data = mono_lake_clean, fill = \"darkcyan\", size = 1) +\n  annotate(geom = \"point\", x = 1979, y = 6373.40, color = \"darkblue\", size = 2, hjust =0) +\n  annotate(\"text\", x = 1979, y = 6410, color = \"darkblue\", label = \"Public Trust Suit initiates\") +\n  geom_segment(aes(x = 1979, y = 6373.40, xend = 1979, yend = 6406), color = \"darkblue\") +\n  annotate(geom = \"point\", x = 1983, y = 6378.60, color = \"darkmagenta\", size = 2, hjust =0) +\n  annotate(\"text\", x = 1983, y = 6400, color = \"darkmagenta\", label = \"Public Trust Doctrine\") +\n  geom_segment(aes(x = 1983, y = 6378.60, xend = 1983, yend = 6398), color = \"darkmagenta\") +\n  annotate(geom = \"point\", x = 1994, y = 6374.60, color = \"red\", size = 2, hjust =0) +\n  annotate(\"text\", x = 1994, y = 6390, color = \"red\", label = \"Decision 1631\") +\n  geom_segment(aes(x = 1994, y = 6374.60, xend = 1994, yend = 6388), color = \"red\") +\n  labs(x = \"Year\", y = \"Lake level (in ft above sea level)\", title = \"Mono Lake: History of Lake Levels and Major Court Cases\", subtitle = \"1850 - 2017\") +\n  theme_minimal()\n\n\n\n\nFigure 1: Historic lake levels of Mono Lake from 1850 - 2017. Mono Lake has suffered ecologically from diversions of water toward Los Angeles. As the lake levels have dropped, the lake has experienced negative ecological consequences. As the lake level decreases to 6,377ft above sea level (yellow line), land bridges emerge between the mainland and islands allowing predators to access major bird nesting sites. If lake levels decreased below 6,360ft (dark red line), lake salinity would reach 120 g/L decreasing brine shrimp populations and the California gull populations that depend on brine shrimp. At 6,350ft (black line) the impact of salinity would be above 150 g/L. In 1979 (highlighted in dark blue), Public Trust Suit brought before the Mono County Superior Court by the National Audubon Society, Mono Lake Committee, and others. This process was the cornerstone of the legal efforts to protect Mono Lake from diversion by the City of Los Angeles Department of Water and Power (DWP). Eventually the case was carried up to the California Supreme Court. In 1983 (highlighted in purple), the California Supreme Court ruled that water diversions by the LA DWP violated the Public Trust Doctrine - stating that certain resources are too valuable to be privately owned and must remain available for public use - invalidating LA’s prior water allocation decisions of the streams feeding the lake.In 1994 (highlight in red), the State Water Resouces Control Board issued Decision 1631, a landmark decision amending DWP’s water diversion licenses in the Mono Basin to proctect fisheries and ensure the lake’s public trust values were protected (Data: Mono Basin Clearinghouse).\n\n\n\n\n\n\n",
    "preview": "research_portfolio/2022-03-08-Mono-Lake/Mono-Lake-analysis_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-03-11T11:38:51-08:00",
    "input_file": "Mono-Lake-analysis.knit.md"
  },
  {
    "path": "research_portfolio/2022-02-25-hares/",
    "title": "Bonanza Creek LTER Snowshoe Hare Weight Analysis",
    "description": "This analysis looks at differences in snowshoe hare weights between male and female sexes at three different monitoring sites within the Bonanza Creek U.S. Long Term Ecological Research Network in Interior Alaska from 1999 - 2012.",
    "author": [
      {
        "name": "Brendan McGovern",
        "url": {}
      }
    ],
    "date": "2022-02-25",
    "categories": [],
    "contents": "\nIntroduction\nThis report provides an exploratory overview of differences in snowshoe hare weights between male and female sexes at three different monitoring sites within the Bonanza Creek U.S. Long Term Ecological Research Network in Interior Alaska from 1999 - 2012 (Kielland et al. 2017). Specifically, weight is compared between sex, and the relationship between weight and hind foot length are explored.\nData and analyses\nSnowshoe hare measurements were collected and made available by Dr. Knut Kielland and colleagues at the Bonanza Creek LTER network site in Bonanza Creek Experimental Forest in Interior Alaska. The data contains 3197 observations of snowshoe hares on a variety of parameters, collected between 1999 and 2012. Following an exploratory data visualization, weights between male and female snowshoe hares are examined by two-sample t-tests using a significance level (\\(\\alpha\\)) of 0.05 throughout. Differences between groups are described by Cohen’s d effect size. The relationship between weight and hind foot length is explored using a simple linear regression. All analyses are in R version 4.0.2 using RStudio version 1.3.1056.\nExploratory Findings\nAnnual juvenile hare trap counts\nFrom Figure 1 it appears that the observations of juvenile snowshoe hare trap counts have declined between 1999 and 2012. The maximum juvenile snowshoe hare trap count was 167 in 1999 and the minimum juvenile hare trap counts are 0 in 2002 and 2009. The mean and median counts across the study period are 27 and 16 (rounded from 15.5), respectively. Without a deeper understanding of the frequency of the trap counts it appears that juvenile snowshoe hare counts have decreased fairly substantially between 1999 and 2012. It appears that there was some inconsistency across the number of days per year where researchers counted juvenile hares. To overcome this inconsistency, I would suggest determining a set length of days to make observations (i.e. 15 days per year) during the same period of time in order to get more consistent sampling.\n\n\nhide\n\n# Read in the data\nbonanza_hares <- read.csv(file ='data/bonanza_hares.csv')\n\n\n\n\n\nhide\n\n# i. Annual juvenile hare trap counts from 1999-2012\n\n# cleaning up data, to focus on juvenile hares, extract date info, and rename sites for clarity\nbonanza_hares_juvenile <- bonanza_hares %>% \n  filter(age == \"j\", na.rm = TRUE) %>% \n  mutate(date_new = mdy(date)) %>% \n  mutate(month_new = month(date_new)) %>% \n  mutate(year_only = year(date_new)) %>%\n  mutate(study_site = case_when(\n    grid == \"bonrip\" ~ \"Bonanza Riparian\",\n    grid == \"bonbs\" ~ \"Bonanza Spruce\",\n    grid == \"bonmat\" ~ \"Bonanza Mature\")) %>% \n  mutate(full_sex = case_when(\n    sex == \"m\" ~ \"male\",\n    sex == \"f\" ~ \"female\"))\n\n# Adding years with a zero observations:\n\nbonanza_hares_j_count <- bonanza_hares_juvenile %>% \n  count(year_only) %>% \n  complete(year_only = 1999:2012,\n           fill = list(n = 0))\n\n\n\n\n\nhide\n\n# Looking at mean and median from 1999 to 2012\n\n#bonanza_hares_j_count %>%\n #summarize(mean_count = mean(n, na.rm=TRUE),\n            #median_count = median(n))\n\n\n\n\n\nhide\n\n# Plot juvenile hare counts by year from 1999 to 2012\n\nggplot() +\n  geom_col(data = bonanza_hares_j_count, aes(x = year_only, y = n),\n           fill = \"dark cyan\", color = \"black\") + \n  labs(x = \"Year\", y = \"Juvenile snowshoe hare count\", title = \"Annual juvenile hares trap counts across all monitoring sites\", subtitle = \"(between 1999-2012)\") +\n  theme_light()\n\n\n\n\nFigure 1 Graph of the total number of juvenile snowshoe hares trapped and counted across the three monitoring sites annually between 1999-2012. Data: Kielland et al.(2017).\n\n\nhide\n\n# Summary statistics comparing juvenile hare weights by sex\n\nbonanza_hares_juvenile_summary <- bonanza_hares_juvenile %>%\n  drop_na(weight) %>% \n  group_by(full_sex) %>% \n  summarize(\n    mean_weight = mean(weight),\n    median_weight = median(weight),\n    sd_weight = sd(weight),\n    sample_size = n(),\n    se_weight = sd(weight) / sqrt(n()),\n    var_weight = var(weight)\n  )\n\n\n\nVisualize juvenile hare weights\nDistributions of hare weights by sex across the three monitoring sites are relatively normally distributed between 1999 and 2012 in Figure 2. We can see that juvenile hares tended to be counted at the highest rate at the Bonanza Riparian monitoring site. There are a few instances where hare sex was undetermined, but weight was specified. In order to avoid impacting the male and female data, undetermined values are left as “NA”.\n\n\nhide\n\n# ii. Visualize juvenile hare weights\n# Plotting juvenile hare weights by sex and site (grid)\n\nggplot(data = bonanza_hares_juvenile, aes(x= full_sex, y = weight)) +\n  geom_beeswarm(aes(color = full_sex)) +\n  scale_color_manual(values = c(\"goldenrod2\", \"cyan4\"), na.value = \"green3\") +\n  facet_wrap(~study_site) +\n  labs(x = \"Sex\", y = \"Weight (gm)\", title = \"Snowshoe hare weights by monitoring site\", col = \"Sex\") +\n  geom_boxplot(fill = NA, width = 0.2, outlier.color = NA) +\n  stat_summary(full=mean,\n               geom=\"point\",\n               shape=20,\n               size=3,\n               color=\"black\",\n               fill=\"black\") +\n  theme_minimal() \n\n\n\n\nFigure 2 Weight (in grams) for snowshoe hares by sex across the three monitoring sites (Bonanza, Bonanza Mature and Bonanza Riparian) during the study period from 1999-2012. Gold (female), teal (male), and light green (NA) points indicate observations of hare weights by sex and monitoring site across the juvenile hare population. NA values correspond to weight values where sex could not be determined. Box endpoints indicate the 25th and 75th percentile values; the black line and black point within each box indicates median and mean value for each hare by site, respectively. Data: Kielland et al.(2017).\nJuvenile weight comparison (male and female snowshoe hares)\nTable 1 Descriptive statistics (mean, median, standard deviation, and sample size) between female and male snowshoe hares. Data: Kielland et al. 2017.\n\n\nhide\n\n# Table of mean, standard deviation, and sample size for male and female juvenile snowshoe hares\n\n# Juvenile weight comparison (male and female hares)\n\njuvenile_comparison <- bonanza_hares_juvenile %>% \n  drop_na(sex) %>%\n  mutate(full_sex = case_when(\n    sex == \"m\" ~ \"male\",\n    sex == \"f\" ~ \"female\"))\n\njuvenile_table <- juvenile_comparison %>%\n  drop_na(weight) %>% \n  group_by(full_sex) %>%\n  summarize(\n    mean_weight = mean(weight),\n    median_weight = median(weight),\n    sd_weight = sd(weight),\n    sample_size = n()\n    ) \n\n\n\n\n\nhide\n\n# Applying some code to make the summary table appear more presentable in the final product:\njuvenile_table %>%\n  kable(col.names = c(\"Sex\", \"Mean weight (gm)\", \"Median weight (gm)\", \"Standard deviation (gm)\", \"Sample size\")) %>% \n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE)\n\n\n\nSex\n\n\nMean weight (gm)\n\n\nMedian weight (gm)\n\n\nStandard deviation (gm)\n\n\nSample size\n\n\nfemale\n\n\n855.3909\n\n\n825\n\n\n292.2526\n\n\n197\n\n\nmale\n\n\n945.8589\n\n\n990\n\n\n333.2151\n\n\n163\n\n\n\n\nhide\n\n# Prepping for Cohen's *d* and two-sample T-test:\n\n# Pull vectors on male and female weight\n\njuvenile_comparison_male <- juvenile_comparison %>% \n  filter(!is.na(weight)) %>% \n  filter(full_sex == \"male\") %>% \n  pull(weight)\n\njuvenile_comparison_female <- juvenile_comparison %>%\n  filter(!is.na(weight)) %>% \n  filter(full_sex == \"female\") %>% \n  pull(weight)\n\n# Plot histograms and qq-plots to ensure normal distributions and relatively linear look for both male and female populations\nhist(juvenile_comparison_male)\n\n\n\nhide\n\nqqnorm(juvenile_comparison_male)\n\n\n\nhide\n\nhist(juvenile_comparison_female)\n\n\n\nhide\n\nqqnorm(juvenile_comparison_female)\n\n\n\nhide\n\n# Both populations are relatively normally distributed, so t-test should be appropriate\njuvenile_comparison_ttest <- t.test(juvenile_comparison_male, juvenile_comparison_female)\njuvenile_comparison_ttest_tidy <- tidy(juvenile_comparison_ttest)\n\n# means and sds for both sexes\nmale_mean <- mean(juvenile_comparison_male)\nfemale_mean <- mean(juvenile_comparison_female)\nmale_sd <- (sd(juvenile_comparison_male))\nfemale_sd <- (sd(juvenile_comparison_female))\n\n# This will generate the effect size\njuvenile_comparison_effsize <- cohen.d(juvenile_comparison_male, juvenile_comparison_female)\n\n\n\nJuvenile snowshoe hare weights (gm) were compared between the two sexes; monitoring site was not included as a variable here, but it would be interesting to consider how weight characteristics differ across each site. On average, juvenile male hares weighed the most (945.8588957 \\(\\pm\\) 333.2150693 grams, n = 163; mean \\(\\pm\\) 1 standard deviation), compared to female hares (855.3908629 \\(\\pm\\) 292.2525894 grams, n = 197; mean \\(\\pm\\) 1 standard deviation)(Table 1). While the absolute difference in means is 90.47 grams (a 10.05% difference), the difference in means is significant (Welch’s two-sample t-test: t(325.02) = 2.71, p = 0.007093279), and the effect size is large (Cohen’s d = 0.29).\nRelationship between juvenile weight and hind foot length\nAs a starting point, the relationship between weight and hind foot length was explored (ignoring sex and monitoring site). A further analysis should be conducted to compare the relationship between weight and hind foot length between male and female hares, and should include monitoring site as an additional variable.\n\n\nhide\n\n# iv. Relationship between juvenile weight and hind foot length, includes both male and female\n\n# Plotting just to explore relationship between weight and hind foot length\nggplot(data = bonanza_hares_juvenile, aes(x = weight, y = hindft)) +\n  geom_point(size = 1.5) +\n  labs(x = \"Hare weight (gm)\", y = \"Hind foot length (mm)\", title = \"Relationship of juvenile snowshoe hare hind foot length to weight\")\n\n\n\n\n\n\nhide\n\n# Creating a linear model comparing hind foot length and weight in juvenile snowshoe hares\n\njuvenile_lm <- lm(weight ~ hindft, data = bonanza_hares_juvenile)\n\n# Converting the output format into nice table\njuvenile_lm_tidy <- tidy(juvenile_lm)\njuvenile_lm_out <- glance(juvenile_lm)\n\n# See model diagnostics for residuals:\nplot(juvenile_lm)\n\n\n\nhide\n\n# Calculate Pearson's r correlation\njuvenile_cor <- cor.test(bonanza_hares_juvenile$weight, bonanza_hares_juvenile$hindft)\n\n# Make a tidy version of correlation output:\njuvenile_cor_tidy <- tidy(juvenile_cor)\n\n\n\nThe relationship between weight and hind foot length appears fairly linear in Figure 3. A simple linear regression was used to explore the relationship between snowshoe hare weight (gm) and hind foot length (mm) across the snowshoe hares including all three monitoring sites, and includes both male and female snowshoe hares. The simple linear regression revealed that hind foot length moderately predicts hare weight (p < 0.001, R2 = 0.3 with an average slope of \\(\\beta\\) = 9.52g mm-1 (i.e. for each one millimeter increase in hind foot length we expect an average increase of hare weight of 9.52 g). Hind foot length and weight have a medium positive correlation (Pearson’s r = 0.55, p < 0.001). We can see from the results that the residuals are heteroscedastic.\n\n\nhide\n\nggplot(data = bonanza_hares_juvenile, aes(x = hindft, y = weight)) +\n  geom_point(aes(color = full_sex, pch = full_sex), size = 2) +\n  scale_color_manual(values = c(\"goldenrod2\", \"cyan4\", \"green4\"),\n                     name = \"Hare Sex\") +\n  scale_shape_manual(values = c(16,17,18),\n                     name= \"Hare Sex\") +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"gray30\") +\n  theme_minimal() +\n  labs(x = \"\\nHind foot length (mm)\",\n       y = \"Weight (gm)\\n\") +\n  theme(legend.position = c(.095, 0.75))\n\n\n\n\nFigure 3 Relationship between weight (gm) and hind foot length (mm) for snowshoe hares (includes all monitoring sites). Points indicate snowshoe hare weight measurements(female hares = gold circles; male hares = teal triangles). Linear model summary: \\(\\beta\\)1 = 9.52 g mm-1, p < 0.001, R2 = 0.3, Pearson’s r = 0.55), Data: Kielland et al. (2017).\nSummary\nExploratory data analysis reveals the following initial findings:\nJuvenile male snowshoe hares are typically larger than female hares in both mean weight (gm) and hind foot length (mm)\nHind foot length appears linearly related with weight across both snowshoe hare sexes; the relationship (by simple linear regression) is significant, with a slope (expected average increase in weight with a 1 mm increase in hind foot length) of 9.52 g mm-1.\nCitation\nKielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14 (Accessed 2020-11-15).\n\n\n```{.r .distill-force-highlighting-css}\n\n\n",
    "preview": "research_portfolio/2022-02-25-hares/hares_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2022-03-11T11:37:51-08:00",
    "input_file": {}
  },
  {
    "path": "research_portfolio/2022-02-25-palmetto-analysis/",
    "title": "Binary Logistic Regression: Florida Palmetto Species",
    "description": "In this project, I examined Florida palmetto data through exploratory visaulizations and used binary logistic regression to classify palmetto species.",
    "author": [
      {
        "name": "Brendan McGovern",
        "url": {}
      }
    ],
    "date": "2022-02-25",
    "categories": [],
    "contents": "\nFlorida palmetto binary logistic regression analysis\nThis anaylsis will utilize data from Abrahamson, 2019, on Florida palmetto characteristics. We will use binary logistic regression to test feasibility of using variables plant height, canopy length, canopy width, and number of green leaves to classify whether a palmetto is Serenoa repens or Sabal etonia.\n\n\nhide\n\npalmetto_data <- read.csv(file = 'data/palmetto.csv') %>% \n  clean_names() %>%\n  mutate(species_name = case_when(\n    species == \"1\" ~ \"Serenoa repens\",\n    species == \"2\" ~ \"Sabal etonia\")\n  )\n\n\n\n\n\nhide\n\n## Exploring the data with ggpairs\n\n#palmetto_data %>%\n  #select(species, height:green_lvs) %>%\n  #ggpairs(aes(color = species))\n\n\n\nExploratory data visualization\nFrom our exploratory analysis of the variables, we can see that the number of green leaves seems to have the greatest impact on determining the difference between the species from the variables we have analyzed. Height, width and length do not produce noticeable differences between species.\n\n\nhide\n\n## Height and length does not really show much variation\n\nggplot(data = palmetto_data, aes(x = height, y = length)) +\n  geom_point(aes(color = species_name), na.rm = TRUE) +\n  labs(x = 'Height (in cm)',\n       y = 'Widest length of canopy (in cm)',\n       title = 'Relationship of Palmetto tree height and canopy length at widest point',\n       col = \"Species\") +\n  theme_minimal()\n\n\n\n\nFigure 1 Of the variables of interest in this analysis the height (in cm) and widest length of canopy (in cm) do not appear to be distinguishable between palmetto species Sabal etonia (red) Serenoa repens (blue) (Data: Abrahamson, 2019).\n\n\nhide\n\nggplot(data = palmetto_data, aes(x = length, y = width)) +\n  geom_jitter(aes(color = species_name), na.rm = TRUE) +\n  labs(x = 'Canopy length (in cm)', \n       y = 'Widest Length of Canopy (in cm)', \n       title = 'Relationship of Palmetto tree canopy width and canopy length',\n       col = \"Species\") +\n  facet_wrap(~species_name) +\n  theme_minimal()\n\n\n\n\nFigure 2 Canopy width and the length (at widest point) of the canopy plotted against each other. Scatterplot showing relationship between length and width. There is no discernable pattern between these two variables to distinguish palmetto species Sabal etonia (red) or Serenoa repens (blue) apart (Data: Abrahamson, 2019).\n\n\nhide\n\nggplot(data = palmetto_data, aes(x = green_lvs, y = height)) +\n  geom_jitter(aes(color = species_name), na.rm = TRUE) +\n  labs(x = 'Height (in cm)',\n       y = 'Count of Green Leaves',\n       title = 'Relationship of Palmetto tree height and count of green leaves',\n       col = \"Species\") +\n  theme_minimal()\n\n\n\n\nFigure 3 Of the variables of interest in this analysis the count of green leaves appears to be a decent determinant of distinguishing palmetto species Sabal etonia (red) and Serenoa repens (blue) from each other (Data: Abrahamson, 2019).\n\n\nhide\n\n# removing columns that are not necessary\n\npalmetto_variables <- palmetto_data %>%\n  mutate(species = as.factor(species)) %>% \n  select(-year,-plant, -site, -habitat, -treatment, -survival, -scape, -new_lvs, -biomass, -canopy, -lf_long, -comments) %>% \n  drop_na()\n\n\n\nBinary Logistic Regression Analysis\nBased on these plots the number of green leaves are more likely to help classify species correctly, but to be sure we will perform a binary logistic regression to determine the probability of a plant being either Serenoa repens or Sabal etonia based on these predictor variables.\n\n\nhide\n\n# coding in two models to predict palmetto species\n\nf1 <- species ~ height + length + width + green_lvs\nf2 <- species ~ height + width + green_lvs\n\npalmetto_blr1 <- glm(formula = f1,\n                    data = palmetto_variables,\n                    family = 'binomial')\npalmetto_blr2 <- glm(formula = f2,\n                     data = palmetto_variables,\n                     family = 'binomial')\n\n\n\n\n\nhide\n\n# applying tidy to clean them up\nblr1_tidy <- broom::tidy(palmetto_blr1)\nblr2_tidy <- broom::tidy(palmetto_blr2)\n\n\n\n\n\nhide\n\n# Convert log odds to probability\n\nblr1_fitted <- palmetto_blr1 %>% \n  broom::augment(type.predict = 'response') \n\nblr2_fitted <- palmetto_blr2 %>% \n  broom::augment(type.predict = 'response') \n\n\n\nModel Selection\nWe are interested in performing a binary logistic regression to determine the probability of a plant being either Serenoa repens or Sabal etonia based on several predictor variables. This will help me compare the two models and determine which one might better predict a plant to be Serenoa repens or Sabal etonia.\nModel 1: Log odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variables Model 2: Log odds of plant type using plant height, canopy width, and green leaves.\nUsing AIC to compare the two models, it appears that Model 1 is a superior model. Model 2 receives a AIC_c value of 792.91 when compared to Model 1. However, we conducted a ten-fold cross validation, repeated 20 times, Model 1 still appears to be a better model at predicting plant species. Model 1 has an accuracy of 0.916 and Model 2 has an accuracy of 0.898.\nTable 1 Using AIC to compare Model 1 and Model 2. Based on the Delta_AICc score, Model 1 appears to be a better model (Data: Abrahamson, 2019).\n\n\nhide\n\n#Performing AIC to see which model appears to be better suited\n\n#AICcmodavg::aictab(list(palmetto_blr1, palmetto_blr2))\n\nkable(AICcmodavg::aictab(list(palmetto_blr1, palmetto_blr2))) %>%\n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE)\n\n\n\nModnames\n\n\nK\n\n\nAICc\n\n\nDelta_AICc\n\n\nModelLik\n\n\nAICcWt\n\n\nLL\n\n\nCum.Wt\n\n\nMod1\n\n\n5\n\n\n5194.567\n\n\n0.0000\n\n\n1\n\n\n1\n\n\n-2592.281\n\n\n1\n\n\nMod2\n\n\n4\n\n\n5987.475\n\n\n792.9086\n\n\n0\n\n\n0\n\n\n-2989.736\n\n\n1\n\n\n\n\nhide\n\n# using caret\n\nset.seed(123)\n\ntr_ctrl <- trainControl(method = 'repeatedcv', number = 10, repeats = 20)\n\n### train the model\nmodel1 <- train(f1, data = palmetto_variables,\n                method = 'glm', family = 'binomial',\n                trControl = tr_ctrl)\nmodel2 <- train(f2, data = palmetto_variables,\n                method = 'glm', family = 'binomial',\n                trControl = tr_ctrl)\n\n#model1\n\n\n\nTable 2 Output from binary logistic regression using Model 1, which looks at plant height, canopy length, canopy width, and green leaves as predictor variables to evaluate the probability that a plant is either Serenoa repens or Sabal etonia (Data: Abrahamson, 2019).\n\n\nhide\n\nkable(blr1_tidy, digits = 135) %>%\n  kable_styling(latex_options = \"striped\", full_width = FALSE)\n\n\n\nterm\n\n\nestimate\n\n\nstd.error\n\n\nstatistic\n\n\np.value\n\n\n(Intercept)\n\n\n3.22668508\n\n\n0.142070846\n\n\n22.71180\n\n\n3.424977e-114\n\n\nheight\n\n\n-0.02921731\n\n\n0.002306052\n\n\n-12.66984\n\n\n8.689251e-37\n\n\nlength\n\n\n0.04582325\n\n\n0.001866072\n\n\n24.55600\n\n\n3.730000e-133\n\n\nwidth\n\n\n0.03944340\n\n\n0.002100033\n\n\n18.78227\n\n\n1.054719e-78\n\n\ngreen_lvs\n\n\n-1.90847471\n\n\n0.038863375\n\n\n-49.10728\n\n\n0.000000e+00\n\n\nApplying Model 1 to Palmetto Data\n\n\nhide\n\n# Take model results and determine species predictions when >= 50% or <50%\n\nblr1_fitted_table <- blr1_fitted %>% \n  select(species, .fitted) %>% \n  mutate(predicted_sp = case_when(\n    .fitted >= .5 ~ \"2\",\n    .fitted < .5 ~ \"1\"))\n\n# adding when model predicted correctly and incorrectly\nblr1_fitted_table_accurate <- blr1_fitted_table %>% \n  mutate(classification = case_when(\n    species == predicted_sp ~ \"Correct\",\n    species != predicted_sp ~ \"Incorrect\")) %>% \n  group_by(species, classification) %>% \n  count(classification)\n\n# adding species names\nblr1_fitted_table_final <- blr1_fitted_table_accurate %>% \n  pivot_wider(names_from = classification, values_from = n) %>%\n  mutate(species = case_when(\n    species == 1 ~ \"Serenoa repens\",\n    species == 2 ~ \"Sabal etonia\")) %>% \n  column_to_rownames(var = \"species\")\n\n# adding percentage models predicted correctly as a column\nblr1_fitted_table_final[\"Percentage Correct\"] = blr1_fitted_table_final[\"Correct\"]/(blr1_fitted_table_final[\"Incorrect\"] + blr1_fitted_table_final[\"Correct\"])*100\n\n\n\nThis analysis shows that using binary logistics regression, a model that includes plant height, canopy length, canopy width, and the number of green leaves of palmetto species can with high accuracy classify a species as either Serenoa repens or Sabal etonia. The model was able to classify Serenoa repens with 90.77% accuracy and Sabal etonia with 92.62% accuracy.\nTable 2 Depicts the count of “Correct” and “Incorrect” classifications of each species when using binary logistic regression to Model 1 with a 50% cutoff. A 50% cutoff indicates that any observation over 50% is deemed Sabal entonia.\n\n\nhide\n\nkable(blr1_fitted_table_final) %>% \n  kable_styling(full_width = FALSE) %>% \n  column_spec(1, italic = TRUE)\n\n\n\n\n\nCorrect\n\n\nIncorrect\n\n\nPercentage Correct\n\n\nSerenoa repens\n\n\n5548\n\n\n564\n\n\n90.77225\n\n\nSabal etonia\n\n\n5701\n\n\n454\n\n\n92.62388\n\n\nData source: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\n\n\n\n",
    "preview": "research_portfolio/2022-02-25-palmetto-analysis/palmetto-analysis_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-03-11T11:40:06-08:00",
    "input_file": "palmetto-analysis.knit.md"
  }
]
